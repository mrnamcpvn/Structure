<div class="animated fadeIn">
    <!--/.row-->
    <div class="row">
      <!--/.col-->
      <div class="col-lg-12">
        <div class="card">
          <div class="card-header">
            <div class="row mt-2">
              <label class="col-md-2 col-form-label">Defect Reason</label>
              <div class="col-md-2">
                <input
                  type="text"
                  id="defectreasonid"
                  [(ngModel)]="paramSearch.defect_Reason"
                  class="form-control model-search"
                  placeholder="search"
                  required
                />
              </div>
              <label class="col-md-1 col-form-label" for="active"> Active </label>
              <div class="col-md-2">
                <select
                [(ngModel)]="paramSearch.active"
                  value="all"
                  class="form-control"
                  id="active"
                >
                  <option value="all">All</option>
                  <option value="1">Active</option>
                  <option value="0">InActive</option>
                </select>
              </div>
              <div class="col-md-4">
                <button
                  type="button"
                  class="btn btn-secondary"
                  (click) = "searchDr()"
                >
                  <i class="fa fa-search"></i> Search
                </button>
                <button
                  type="button"
                  class="btn btn-danger"
                  (click) ="clearDr()"
                >
                  <i class="fa fa-ban"></i>
                  <span>Clear</span>
                </button>
              </div>
            </div>
          </div>
          <div class="card-body">
            <div class="add-new">
              <button
                type="button"
                class="btn btn-sm btn-primary float-left mb-2"
                (click) = "addNew()"
              >
                <i class="fa fa-plus"></i> Add new
              </button>
              <button
                type="button"
                class="btn btn-sm btn-primary float-left mb-2 ml-1"
                (click)="importExcelModel.show()"
              >
              <i class="fa fa-file-excel-o"></i> Import Excel
              </button>
            </div>
            <div class="table-responsive">
              <table class="table table-bordered">
                <thead>
                  <tr>
                    <th>Edit</th>
                    <th>Defect Reason ID</th>
                    <th>Defect Reason Name</th>
                    <th>Sequence</th>
                    <th>Active</th>
                    <th>Update By</th>
                    <th>Update Time</th>
                  </tr>
                </thead>
                <tbody *ngIf="defectreasons.length == 0">
                  <tr >
                   <td colspan="9">
                     <div class="alert-table alert alert-warning"> 
                       No data found !
                     </div>
                   </td>
                 </tr>
                 </tbody>
                <tbody
                id="list{{ idx }}"
                *ngFor="let defectreason of defectreasons; let idx = index"
                 >
                  <tr>
                    <td>
                      <!-- edit btn -->
                      <button
                        type="button"
                        class="btn btn-primary btn-sm ml-4"
                        (click)="edit(defectreason)"
                      >
                        <i class="fa fa-edit fa-lg"></i>
                      </button>
                    </td>
                    <td>{{ defectreason.defect_reason_id }}</td>
                    <td>{{ defectreason.defect_reason_name }}</td>
                    <td>{{ defectreason.sequence }}</td>
                    <td>
                      <div class="col-md-3">
                        <div class="custom-control custom-checkbox">
                          <input
                            type="checkbox"
                            name="is_active"
                            id="is_active"
                            class="custom-control-input"
                            [(ngModel)]="defectreason.is_active"
                          />
                          <label class="custom-control-label"></label>
                        </div>
                      </div>
                    </td>
                    <td>{{ defectreason.update_by}}</td>
                    <td>
                        {{ defectreason.update_time | date: "yyyy/MM/dd HH:mm" }}
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="d-flex" *ngIf="pagination.totalPages >= 1">
              <pagination
                [boundaryLinks]="true"
                [totalItems]="pagination.totalItems"
                [itemsPerPage]="pagination.itemsPerPage"
                (pageChanged)="pageChanged($event)"
                previousText="&lsaquo;"
                nextText="&rsaquo;"
                firstText="&laquo;"
                lastText="&raquo;"
                [maxSize]="5"
              >
              </pagination>
            </div>
          </div>
        </div>
      </div>
      <!--/.col-->
    </div>
  </div>



  <div #importExcelModel="bs-modal" bsModal class="modal fade" tabindex="-1">
    <div class="modal-dialog modal-md">
      <div class="modal-content">
        <form #importExcel="ngForm">
          <div class="modal-header">
            <strong>Import Excel Product Category</strong>
            <button type="button" class="close pull-right" aria-label="Close"
              (click)="importExcelModel.hide()">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body">
            <p style="color: red;">* Please select a file '.xlsx' or '.xlsm'
              <a href="javascript:;" (click)="downloadExcelTemplate()">follow this form here</a>
            </p>
            <div class="form-group">
              <div class="custom-file b-form-file">
                <label data-browse="Browse" class="custom-file-label">
                  <p *ngIf="fileImportExcel === null">Choose a file...</p>
                  <input id="input_uploadFile"
                    accept="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel"
                    type="file" (change)="onSelectFile($event)" style="line-height: 1 !important; outline: none;"
                    [ngClass]="(fileImportExcel !== null) ? 'opacity1' : 'opacity0'">
                </label>
              </div>
            </div>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" (click)="importExcelModel.hide()">Cancel</button>
            <button type="submit" class="btn btn-success" (click)="[importExcelModel.hide(), import()]"
              [disabled]="fileImportExcel === null">
              Import
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>
  